<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberGuard: Financial Scam Detection Training</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>

        /* GENERAL STYLES */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Courier New', monospace;
        }
        
        body {
            background: linear-gradient(135deg, #000000, #212121, #000000);
            min-height: 100vh;
            color: #00ff00;
            display: flex;
            justify-content: center;
            align-items : center;
            padding: 20px;
        }
        
        .container {
            width: 100%;
            /* Adjust height automatically based on aspect ratio */
            height: auto;
            /* Maintain a 16:9 aspect ratio on larger screens */
            aspect-ratio: 16 / 9;
            /* Prevent the container from exceeding the viewport height */
            max-height: 95vh;
            background: #000000;
            border: 2px solid #00ff00;
            box-shadow: 0 0 30px rgba(0,255,0,0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0,255,0,0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,255,0,0.05) 1px, transparent 1px);
            background-size: 25px 25px;
            pointer-events: none;
            z-index: 1;
        }

        /* HEADER */
        header {
            background: #000000;
            color: #00ff00;
            padding: 15px 20px;
            text-align: center;
            border-bottom: 2px solid #00ff00;
            position: relative;
            z-index: 2;
        }
        
        header h1 {
            font-size: 2rem;
            text-shadow: 0 0 10px #00ff00;
            letter-spacing: 2px;
            margin-bottom: 10px;
        }

        .progress-container {
            height: 6px;
            background: #333;
            width: 100%;
            max-width: 400px;
            margin: 0 auto;
            border-radius: 3px;
            overflow: hidden;
            border: 1px solid #00ff00;
        }
        
        .progress-bar {
            height: 100%;
            background: #00ff00;
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 5px #00ff00;
        }
        
        /* LEVEL SELECTION */
        .level-selection-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            flex: 1;
            padding: 40px;
            text-align: center;
        }

        .level-selection-screen h2 {
            font-size: 2.5rem;
            color: #00ff00;
            text-shadow: 0 0 15px #00ff00;
            margin-bottom: 40px;
        }

        .level-btn {
            background: linear-gradient(45deg, #1a1a1a, #0a0a0a);
            color: #00ff00;
            border: 2px solid #00ff00;
            padding: 20px 50px;
            font-size: 1.5rem;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            margin: 15px;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            width: 80%;
            max-width: 400px;
        }

        .level-btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 0 20px rgba(0,255,0,0.5);
        }
        
        .level-btn:disabled {
            color: #666;
            border-color: #333;
            cursor: not-allowed;
            background: #111;
        }
        
        .level-btn:disabled .fa-lock {
            margin-left: 10px;
        }


        /* PRE-GAME (LEARNING) PHASE */
        .pre-game-phase {
            display: none; /* Initially hidden */
            flex-direction: column;
            flex: 1;
            overflow: hidden;
        }

        .pre-game-nav {
            display: flex;
            border-bottom: 1px solid #00ff00;
        }

        .nav-btn {
            flex: 1;
            padding: 15px;
            background: #1a1a1a;
            color: #00ff00;
            border: none;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .nav-btn.active {
            background: #00ff00;
            color: #000000;
            text-shadow: 0 0 5px #000000;
        }

        .pre-game-content {
            flex: 1;
            overflow-y: auto;
            padding: 30px;
        }

        .content-section {
            display: none;
        }

        .content-section.active {
            display: block;
        }
        
        .section-title {
            font-size: 1.8rem;
            color: #00ff00;
            margin-bottom: 30px;
            text-align: center;
            text-shadow: 0 0 5px #00ff00;
        }
        
        .info-card {
            background: linear-gradient(135deg, #1a1a1a, #0a0a0a);
            border: 1px solid #00ff00;
            border-radius: 10px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 0 20px rgba(0,255,0,0.2);
        }
        
        .info-card h3 {
            color: #00ff00;
            font-size: 1.4rem;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }
        
        .info-card h3 i {
            margin-right: 12px;
            color: #00ff00;
        }
        
        .info-card p, .info-card li {
            color: #ffffff;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .info-card ul {
            padding-left: 20px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: #1a1a1a;
            border: 1px solid #00ff00;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 0 15px rgba(0,255,0,0.2);
        }
        
        .stat-number {
            font-size: 2.2rem;
            color: #00ff00;
            font-weight: bold;
            text-shadow: 0 0 10px #00ff00;
        }
        
        .stat-label {
            color: #ffffff;
            margin-top: 10px;
        }

        .how-to-play-card {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: #1a1a1a;
            border-radius: 8px;
            border-left: 4px solid #00ff00;
        }

        .how-to-play-icon {
            font-size: 2rem;
            color: #00ff00;
            margin-right: 20px;
            width: 50px;
            text-align: center;
        }
        
        .how-to-play-info h4 {
            color: #00ff00;
            font-size: 1.3rem;
            margin-bottom: 8px;
        }
        
        .how-to-play-info p {
            color: #ffffff;
            line-height: 1.6;
        }
        .how-to-play-info code {
            background-color: #333;
            color: #00ff00;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .start-game-btn {
            background: #333;
            color: #666;
            border: 1px solid #00ff00;
            padding: 15px 40px;
            font-size: 1.3rem;
            font-weight: bold;
            border-radius: 8px;
            cursor: not-allowed;
            display: block;
            margin: 20px auto;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
        }
        
        .start-game-btn:not(:disabled) {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #000000;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(0,255,0,0.5);
        }

        .start-game-btn:not(:disabled):hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(0,255,0,0.7);
        }

        /* GAME PHASE */
        .game-phase {
            display: none;
            flex: 1;
            flex-direction: column;
            overflow: hidden;
        }
        
        .game-phase.active {
            display: flex;
        }
        
        .game-header {
            background: #000000;
            padding: 10px 20px;
            border-bottom: 1px solid #00ff00;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .game-status {
            color: #00ff00;
        }
        
        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }
        
        .app-selector {
            width: 200px;
            background: #1a1a1a;
            border-right: 2px solid #00ff00;
            padding: 20px 0;
            display: flex;
            flex-direction: column;
        }
        
        .app-btn {
            width: 100%;
            padding: 15px 20px;
            background: transparent;
            color: #00ff00;
            border: none;
            text-align: left;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
            display: flex;
            align-items: center;
        }
        
        .app-btn:hover {
            background: #0a0a0a;
            border-left-color: #00ff00;
        }
        
        .app-btn.active {
            background: #00ff00;
            color: #000000;
            border-left-color: #00aa00; /* Darker green for contrast */
        }
        
        .app-btn.visited::after {
            content: '✓';
            color: #ffffff;
            margin-left: auto;
        }
        
        .app-btn i {
            margin-right: 12px;
            width: 20px;
        }
        
        .report-btn {
            margin: auto 10px 10px; /* Top margin auto pushes it to the bottom */
            padding: 12px;
            background: #333;
            color: #666;
            border: 1px solid #00ff00;
            text-align: center;
            font-size: 1rem;
            cursor: not-allowed;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            font-weight: bold;
        }

        .report-btn i {
            margin-right: 10px;
        }

        .report-btn:not(:disabled) {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #000000;
            cursor: pointer;
            box-shadow: 0 0 15px rgba(0,255,0,0.5);
        }

        .report-btn:not(:disabled):hover {
            transform: scale(1.05);
        }

        .app-content {
            flex: 1;
            background: #000000;
            overflow-y: auto;
            position: relative;
        }
        
        .app-screen {
            display: none;
            height: 100%;
        }
        
        .app-screen.active {
            display: block;
        }

        .app-header {
            background: #1a1a1a;
            color: #00ff00;
            padding: 15px;
            border-bottom: 1px solid #00ff00;
            display: flex;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }
        .app-header i { margin-right: 15px; }
        
        /* App Specific Styles */
        .chat-container {
            padding: 20px;
        }
        
        .message {
            max-width: 80%;
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 12px;
            background: #1a1a1a;
            border: 1px solid #00ff00;
            color: #ffffff;
        }
        
        .message-time {
            font-size: 0.8rem;
            color: #00ff00;
            text-align: right;
            margin-top: 8px;
        }
        
        .transaction-screenshot {
            border: 1px solid #00ff00;
            border-radius: 8px;
            margin-top: 10px;
        }

        .balance-card {
            background: linear-gradient(135deg, #1a1a1a, #0a0a0a);
            border: 1px solid #00ff00;
            border-radius: 10px;
            padding: 25px;
            margin: 20px;
            text-align: center;
        }
        
        .balance-label {
            color: #ffffff;
            font-size: 1rem;
            margin-bottom: 10px;
        }
        
        .balance-amount {
            color: #00ff00;
            font-size: 2.5rem;
            text-shadow: 0 0 10px #00ff00;
        }

        .transactions-section h3, .results-screen h3 {
            color: #00ff00;
            font-size: 1.3rem;
            margin: 0 20px 20px;
            border-bottom: 1px solid #00ff00;
            padding-bottom: 10px;
        }
        
        .transaction-item {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 15px;
            margin: 0 20px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .transaction-details h4 { color: #ffffff; margin-bottom: 5px; }
        .transaction-details p { color: #00ff00; font-size: 0.9rem; }
        .transaction-amount { font-size: 1.2rem; }
        .amount-credit { color: #00ff00; }
        .amount-debit { color: #ff0000; } /* Kept red for semantic clarity */

        .message-thread {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 20px;
            border-left: 3px solid #00ff00;
        }

        .thread-sender { color: #00ff00; margin-bottom: 8px; font-weight: bold; }
        .thread-preview { color: #ffffff; margin-bottom: 5px; }
        .thread-time { color: #666; font-size: 0.8rem; }
        .sender-scam { color: #ff0000 !important; font-style: italic; } /* Kept red for semantic clarity */

        /* DECISION MODAL & RESULTS */
        .decision-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.95);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .decision-modal.active {
            display: flex;
        }
        
        .modal-content {
            background: #1a1a1a;
            border: 2px solid #00ff00;
            border-radius: 15px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .modal-title {
            color: #00ff00;
            font-size: 1.8rem;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .transaction-decision {
            background: #0a0a0a;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .transaction-decision h4 { color: #ffffff; margin-bottom: 15px; }
        .decision-buttons { display: flex; gap: 15px; }
        
        .decision-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid;
            border-radius: 6px;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #333;
            color: #ccc;
        }
        
        .btn-legit { border-color: #00ff00; }
        .btn-scam { border-color: #ff0000; } /* Kept red for semantic clarity */
        .decision-btn:hover { transform: scale(1.05); }
        
        .decision-btn.selected.btn-legit {
            background: #00ff00;
            color: #000000;
            box-shadow: 0 0 10px #00ff00;
        }
        
        .decision-btn.selected.btn-scam {
            background: #ff0000; /* Kept red for semantic clarity */
            color: #ffffff;
            box-shadow: 0 0 10px #ff0000;
        }
        
        .submit-decisions-btn {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #000000;
            padding: 15px 30px;
            font-size: 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 20px auto;
            border: none;
        }
        
        .results-screen {
            padding: 40px;
            text-align: center;
            display: none;
            flex: 1; /* Added to fill space */
            overflow-y: auto; /* Added to enable scrolling */
        }
        
        .score-display {
            font-size: 4rem;
            color: #00ff00;
            text-shadow: 0 0 20px #00ff00;
            margin-bottom: 20px;
        }
        
        .result-item {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 20px;
            margin: 0 auto 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 700px;
            text-align: left;
        }
        
        .result-item.correct { border-left: 4px solid #00ff00; }
        .result-item.incorrect { border-left: 4px solid #ff0000; } /* Kept red for semantic clarity */
        
        .result-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .status-correct { background: #00ff00; color: #000000; }
        .status-incorrect { background: #ff0000; color: #ffffff; } /* Kept red for semantic clarity */
        
        .play-again-btn {
            background: linear-gradient(45deg, #00ff00, #00cc00);
            color: #000000;
            border: none;
            padding: 15px 40px;
            font-size: 1.2rem;
            border-radius: 8px;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s ease;
        }
        
        .play-again-btn:hover { transform: scale(1.05); }

        /* RESPONSIVE DESIGN */
        @media (max-width: 768px) {
            body { padding: 0; }
            .container { 
                height: 100vh; 
                max-height: 100vh;
                border: none;
                /* Remove fixed aspect ratio on mobile for full screen experience */
                aspect-ratio: unset;
            }
            .main-content { flex-direction: column; }
            .app-selector {
                width: 100%;
                display: flex;
                flex-direction: row; /* Horizontal for mobile */
                overflow-x: auto;
                padding: 5px;
                border-right: none;
                border-bottom: 2px solid #00ff00;
            }
            .app-btn { flex-shrink: 0; }
            .report-btn { 
                margin: 5px; 
                flex-shrink: 0;
            }
        }

        #bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
        }
        
        .container {
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0);
            border: 2px solid #00ff00;
            box-shadow: 0 0 30px rgba(0,255,0,0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: relative;
            z-index: 1;
        }
        
        .container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(rgba(0,255,0,0.05) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,255,0,0.05) 1px, transparent 1px);
            background-size: 25px 25px;
            pointer-events: none;
            z-index: 1;
        }

        /* HEADER */
        header {
            background: #000000;
            color: #00ff00;
            padding: 15px 20px;
            text-align: center;
            border-bottom: 2px solid #00ff00;
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
        }
        
        header h1 {
            font-size: 2rem;
            text-shadow: 0 0 10px #00ff00;
            letter-spacing: 2px;
            margin: 0;
        }
        
        #mode-toggle {
            font-size: 1.5rem;
            cursor: pointer;
            color: #00ff00;
            background: none;
            border: none;
        }

        .progress-container {
            height: 6px;
            background: #333;
            width: 100%;
            max-width: 400px;
            margin: 0 20px;
            border-radius: 3px;
            overflow: hidden;
            border: 1px solid #00ff00;
        }
        
        .progress-bar {
            height: 100%;
            background: #00ff00;
            width: 0%;
            transition: width 0.5s ease;
            box-shadow: 0 0 5px #00ff00;
        }
        
        /* All original game styles are preserved here */
        .level-selection-screen, .pre-game-phase, .game-phase, .results-screen {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .level-selection-screen { justify-content: center; align-items: center; }
        .results-screen { display: none; }
        .pre-game-phase { display: none; }
        .game-phase { display: none; }
        .main-content { display: flex; flex: 1; overflow: hidden; }
        .app-selector { width: 200px; background: #1a1a1a; border-right: 2px solid #00ff00; padding: 20px 0; display: flex; flex-direction: column; }
        .app-content { flex: 1; background: #000000; overflow-y: auto; position: relative; }
        .pre-game-content { flex: 1; overflow-y: auto; padding: 30px; }
        .level-selection-screen h2 { font-size: 2.5rem; color: #00ff00; text-shadow: 0 0 15px #00ff00; margin-bottom: 40px; }
        .level-btn { background: linear-gradient(45deg, #1a1a1a, #0a0a0a); color: #00ff00; border: 2px solid #00ff00; padding: 20px 50px; font-size: 1.5rem; font-weight: bold; border-radius: 8px; cursor: pointer; margin: 15px; text-transform: uppercase; letter-spacing: 2px; transition: all 0.3s ease; width: 80%; max-width: 400px; }
        .level-btn:hover:not(:disabled) { transform: scale(1.05); box-shadow: 0 0 20px rgba(0,255,0,0.5); }
        .level-btn:disabled { color: #666; border-color: #333; cursor: not-allowed; background: #111; }
        .decision-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .decision-modal.active { display: flex; }
        .modal-content { background: #1a1a1a; border: 2px solid #00ff00; border-radius: 15px; padding: 30px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; }

        /* Light mode styles */
        body:not(.dark-mode) { background: linear-gradient(135deg, #ffffff, #d5d5d5, #ffffff);; color: #EB455F; }
        body:not(.dark-mode) .container { background: rgba(255, 255, 255, 0.0); border-color: #913175; box-shadow: 0 0 20px rgba(145, 49, 117, 0.3); }
        body:not(.dark-mode) header { background: #ffffff; color: #EB455F; border-color: #913175; }
        body:not(.dark-mode) header.dark-mode { background: #000000; color: #00ff00; border-color: #00ff00; } /* Keep header dark in light mode */
        body:not(.dark-mode) header h1 { text-shadow: 0 0 5px #EB455F; }
        body:not(.dark-mode) #mode-toggle { color: #EB455F; }
        body:not(.dark-mode) .progress-container { border-color: #913175; }
        body:not(.dark-mode) .progress-bar { background-color: #EB455F; box-shadow: 0 0 5px #EB455F; }
        body:not(.dark-mode) .level-selection-screen h2 { color: #EB455F; text-shadow: 0 0 10px #EB455F; }
        body:not(.dark-mode) .level-btn { background: linear-gradient(45deg, #ffffff, #e0e0e0); color: #EB455F; border-color: #913175; }
        body:not(.dark-mode) .level-btn:hover:not(:disabled) { box-shadow: 0 0 20px #EB455F; }
        body:not(.dark-mode) .modal-content { background: #fff; border-color: #913175; color: #20262E; }
        body:not(.dark-mode) .app-selector { background: #e9e9e9; border-color: #913175; }
        body:not(.dark-mode) .app-content { background: #f5f5f5; }

    </style>
</head>
<body>
    <canvas id="bg"></canvas>
    <div class="container">
        <header>
            <h1 class="scramble" data-text="CYBERGUARD">CYBERGUARD</h1>

            <button id="mode-toggle"><i class="fas fa-sun"></i></button>
        </header>
        
        <div class="level-selection-screen" id="levelSelectionScreen">
            <h2>SELECT MISSION</h2>
            <button class="level-btn" id="level1Btn">Level 1: Basic Threats</button>
            <button class="level-btn" id="level2Btn" disabled>Level 2: Advanced Deception <i class="fas fa-lock"></i></button>
        </div>

        <div class="pre-game-phase" id="preGamePhase">
            <div class="pre-game-nav">
                <button class="nav-btn active" data-section="howToPlay">How to Play</button>
                <button class="nav-btn" data-section="learningCenter">Threat Intelligence Briefing</button>
            </div>
            <div class="pre-game-content">
                <div class="content-section active" id="howToPlaySection">
                    <h2 class="section-title">MISSION DIRECTIVE</h2>
                    
                    <div class="how-to-play-card">
                        <div class="how-to-play-icon"><i class="fas fa-1"></i></div>
                        <div class="how-to-play-info">
                            <h4>RECEIVE INTEL</h4>
                            <p>You will receive messages in the <code>WhatsApp</code> clone from a scammer claiming they sent you money. They will provide screenshots as "proof."</p>
                        </div>
                    </div>
                    <div class="how-to-play-card">
                        <div class="how-to-play-icon"><i class="fas fa-2"></i></div>
                        <div class="how-to-play-info">
                            <h4>CROSS-REFERENCE DATA</h4>
                            <p>A legitimate transaction will appear in your <code>InstaPay</code> app and will generate a confirmation from an official source in the <code>Messages</code> app.</p>
                        </div>
                    </div>
                    <div class="how-to-play-card">
                        <div class="how-to-play-icon"><i class="fas fa-3"></i></div>
                        <div class="how-to-play-info">
                            <h4>IDENTIFY THREATS</h4>
                            <p>A scam is any transaction that is missing from your InstaPay records. This is your primary method of verification.</p>
                        </div>
                    </div>
                    <div class="how-to-play-card">
                        <div class="how-to-play-icon"><i class="fas fa-level-up-alt"></i></div>
                        <div class="how-to-play-info">
                            <h4>LEVEL 2: VERIFY SENDER</h4>
                            <p>In advanced missions, scammers may send a fake SMS. Always check the sender. A real bank alert comes from an official name like <code>InstaPay Alerts</code>, not a random number like <code>+234 801 234 5678</code>.</p>
                        </div>
                    </div>
                    <div class="how-to-play-card">
                        <div class="how-to-play-icon"><i class="fas fa-4"></i></div>
                        <div class="how-to-play-info">
                            <h4>SUBMIT ANALYSIS</h4>
                            <p>After visiting all three apps, click the "Report Now" button to classify each transaction and submit your report.</p>
                        </div>
                    </div>
                </div>

                <div class="content-section" id="learningCenterSection">
                    <h2 class="section-title">THREAT INTELLIGENCE BRIEFING</h2>
                    <div class="info-card">
                        <h3><i class="fas fa-exclamation-triangle"></i> Threat Overview</h3>
                        <p>Financial scams are a pervasive global threat. In 2023 alone, consumers reported losing over $10 billion to fraud, a 14% increase from the previous year. This simulation targets a common method: the fake payment scam.</p>
                    </div>

                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-number">$10B+</div>
                            <div class="stat-label">Lost to scams in 2023</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">2.6M</div>
                            <div class="stat-label">Fraud reports filed</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-number">25%</div>
                            <div class="stat-label">Reported a financial loss</div>
                        </div>
                    </div>
                    <small style="text-align: center; display: block; color: #666;">Source: U.S. Federal Trade Commission (FTC) Data, 2024</small>

                    <div class="info-card">
                        <h3><i class="fas fa-bullseye"></i> How The Scam Works</h3>
                        <ul>
                            <li><b>Contact:</b> A scammer sends you a message with a fabricated transaction screenshot.</li>
                            <li><b>The Lie:</b> They claim it was a mistake and urgently need you to "refund" the money.</li>
                            <li><b>Pressure:</b> They create a sense of urgency to make you act before you can think or verify.</li>
                            <li><b>The Trap:</b> If you send money, you're sending your own funds. The original transaction never existed.</li>
                        </ul>
                    </div>

                    <div class="info-card">
                        <h3><i class="fas fa-shield-alt"></i> Protective Protocols</h3>
                        <ul>
                            <li><b>Trust but Verify:</b> Never trust a screenshot. Always verify transactions through your official banking app.</li>
                            <li><b>Check the Source:</b> For SMS alerts, verify the sender. Banks use official shortcodes or names, not personal numbers.</li>
                            <li><b>Resist Pressure:</b> Legitimate errors can be resolved through official channels. High-pressure tactics are a major red flag.</li>
                            <li><b>Enable 2FA:</b> Use Two-Factor Authentication on all financial accounts for an extra layer of security.</li>
                        </ul>
                    </div>
                </div>
            </div>
             <button class="start-game-btn" id="startGameBtn" disabled>
                <i class="fas fa-play"></i> BEGIN SIMULATION
            </button>
        </div>
        
        <div class="game-phase" id="gamePhase">
            <div class="game-header">
                <div class="game-status" id="levelIndicator"></div>
                <div class="game-status">Apps Visited: <span id="visitedCount">0</span>/3</div>
            </div>
            
            <div class="main-content">
                <div class="app-selector">
                    <button class="app-btn" data-app="whatsapp">
                        <i class="fab fa-whatsapp"></i> WhatsApp
                    </button>
                    <button class="app-btn" data-app="instapay">
                        <i class="fas fa-university"></i> InstaPay
                    </button>
                    <button class="app-btn" data-app="messages">
                        <i class="fas fa-sms"></i> Messages
                    </button>
                    <button class="report-btn" id="reportNowBtn" disabled>
                        <i class="fas fa-flag"></i> Report Now
                    </button>
                </div>
                
                <div class="app-content">
                    <div class="app-screen whatsapp-screen" id="whatsappScreen">
                        <div class="app-header">
                            <i class="fab fa-whatsapp"></i>
                            <h3>Unknown Sender</h3>
                        </div>
                        <div class="chat-container" id="chatContainer"></div>
                    </div>
                    
                    <div class="app-screen instapay-screen" id="instapayScreen">
                        <div class="app-header">
                            <i class="fas fa-university"></i>
                            <h3>InstaPay Banking</h3>
                        </div>
                        <div class="balance-card">
                            <div class="balance-label">Available Balance</div>
                            <div class="balance-amount">₦45,750.00</div>
                        </div>
                        <div class="transactions-section">
                            <h3>Recent Transactions</h3>
                            <div id="bankTransactions"></div>
                        </div>
                    </div>
                    
                    <div class="app-screen messages-screen" id="messagesScreen">
                        <div class="app-header">
                            <i class="fas fa-sms"></i>
                            <h3>Messages</h3>
                        </div>
                        <div id="smsMessages"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="decision-modal" id="decisionModal">
            <div class="modal-content">
                <h2 class="modal-title">CLASSIFY TRANSACTIONS</h2>
                <p style="text-align:center; color:#ccc; margin-bottom:20px;">All apps visited. Submit your analysis.</p>
                <div id="transactionDecisions"></div>
                <button class="submit-decisions-btn" onclick="submitDecisions()">SUBMIT ANALYSIS</button>
            </div>
        </div>
        
        <div class="results-screen" id="resultsScreen">
            <h2 class="section-title">MISSION RESULTS</h2>
            <div class="score-display" id="scoreDisplay"></div>
            <p id="levelUnlockMessage" style="color:#00ff00; font-size: 1.2rem; margin-bottom: 20px;"></p>
            <h3>Analysis Breakdown</h3>
            <div id="resultBreakdown"></div>
            <button class="play-again-btn" onclick="returnToLevelSelect()">SELECT NEW MISSION</button>
        </div>
    </div>

    <!-- Your Exact Theme, Animation, and Scramble Script -->
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const modeToggle = document.getElementById("mode-toggle");
            const body = document.body;
            const header = document.querySelector("header");
            const icon = modeToggle.querySelector("i");

            let animateStrings = true; // Set to true to allow resizing

            const stringsCanvas = document.getElementById("bg");
            const stringsCtx = stringsCanvas.getContext("2d");

            const NUM_STRINGS = 14;
            const MIN_BALLS_PER_STRING = 1;
            const MAX_BALLS_PER_STRING = 3;
            const BASE_LINE_WIDTH = 1.2;

            let W = 0, H = 0, DPR = Math.max(1, window.devicePixelRatio || 1);
            let strings = [], balls = [];

            function resizeStrings() {
                DPR = Math.max(1, window.devicePixelRatio || 1);
                W = Math.max(300, Math.floor(innerWidth));
                H = Math.max(200, Math.floor(innerHeight));
                stringsCanvas.style.width = W + "px";
                stringsCanvas.style.height = H + "px";
                stringsCanvas.width = Math.floor(W * DPR);
                stringsCanvas.height = Math.floor(H * DPR);
                stringsCtx.setTransform(DPR, 0, 0, DPR, 0, 0);
                buildStringsAndBalls();
            }

            function buildStringsAndBalls() {
                strings = []; balls = [];
                const padding = 40;
                const usableH = Math.max(80, H - padding * 2);
                const spacing = usableH / (NUM_STRINGS - 1 || 1);

                for (let i = 0; i < NUM_STRINGS; i++) {
                    const baseY = padding + i * spacing;
                    const amplitude = Math.min(spacing * 0.36, 60);
                    const waves = 1.0 + (i % 3) * 0.4 + i * 0.02;
                    const freq = (Math.PI * 2 * waves) / W;
                    const phase = Math.random() * Math.PI * 2;
                    const lineWidth = BASE_LINE_WIDTH + (i % 4) / 8;
                    const yOffset = Math.sin(i * 0.7 + Math.random() * 2) * spacing * 0.06;

                    const s = {
                        baseY, amplitude, freq, phase, lineWidth, yOffset,
                        drawProgress: 0,
                        drawSpeed: 0.3 + Math.random() * 0.3,
                    };
                    strings.push(s);

                    const ballsCount = MIN_BALLS_PER_STRING + Math.floor(Math.random() * (MAX_BALLS_PER_STRING - MIN_BALLS_PER_STRING + 1));
                    for (let b = 0; b < ballsCount; b++) {
                        const radius = 2 + Math.random() * 6;
                        const speed = 20 + Math.random() * 140;
                        const direction = Math.random() < 0.5 ? 1 : -1;
                        const x = direction === 1 ? -radius : W + radius;
                        balls.push({ stringIndex: i, x, radius, speed, direction });
                    }
                }
            }

            const stringY = (s, x) => s.baseY + s.yOffset + Math.sin(x * s.freq + s.phase) * s.amplitude;

            function drawStringDark(s, string_color) {
                stringsCtx.beginPath();
                const pts = [];
                const step = Math.max(8, Math.floor(W / 120));
                for (let x = 0; x <= W; x += step) {
                    pts.push([x, stringY(s, x)]);
                }
                if (pts.length > 0 && pts[pts.length - 1][0] !== W) pts.push([W, stringY(s, W)]);

                const currentDrawLength = s.drawProgress * W;
                let drawnLength = 0;

                if (pts.length === 0) return;

                stringsCtx.moveTo(pts[0][0], pts[0][1]);
                for (let i = 1; i < pts.length; i++) {
                    const [x1, y1] = pts[i - 1];
                    const [x2, y2] = pts[i];
                    const segmentLength = Math.sqrt(Math.pow(x2 - x1, 2) + Math.pow(y2 - y1, 2));

                    if (drawnLength + segmentLength > currentDrawLength) {
                        const remainingLength = currentDrawLength - drawnLength;
                        const t = remainingLength / segmentLength;
                        const endX = x1 + (x2 - x1) * t;
                        const endY = y1 + (y2 - y1) * t;
                        stringsCtx.lineTo(endX, endY);
                        break;
                    }
                    const cx = (x1 + x2) / 2;
                    const cy = (y1 + y2) / 2;
                    stringsCtx.quadraticCurveTo(x1, y1, cx, cy);
                    drawnLength += segmentLength;
                }

                stringsCtx.shadowBlur = 12;
                stringsCtx.shadowColor = string_color;
                stringsCtx.lineCap = "round";
                stringsCtx.lineJoin = "round";
                stringsCtx.strokeStyle = string_color;
                stringsCtx.lineWidth = s.lineWidth;
                stringsCtx.stroke();
                stringsCtx.shadowBlur = 0;
            }

            function drawStringLight(s, string_color) {
                stringsCtx.beginPath();
                const numSteps = 120;
                const stepSize = W / numSteps;
                const startStep = Math.floor(s.drawProgress * numSteps);
                
                if (startStep === 0) return;

                stringsCtx.moveTo(0, stringY(s, 0));
                for (let i = 1; i <= startStep; i++) {
                    const x = i * stepSize;
                    stringsCtx.lineTo(x, stringY(s, x));
                }

                stringsCtx.shadowBlur = 12;
                stringsCtx.shadowColor = string_color;
                stringsCtx.lineCap = "round";
                stringsCtx.lineJoin = "round";
                stringsCtx.strokeStyle = string_color;
                stringsCtx.lineWidth = s.lineWidth;
                stringsCtx.stroke();
                stringsCtx.shadowBlur = 0;
            }

            let lastTime = performance.now();
            let currentBallColor = "#00FF00";
            let currentStringColor = "#1b642aff";
            let light = false;
            let animationFrameId;

            function animateStringsFn(now) {
                const dt = Math.min(50, now - lastTime) / 1000;
                lastTime = now;

                strings.forEach(s => s.drawProgress = Math.min(1, s.drawProgress + dt * s.drawSpeed));
                stringsCtx.clearRect(0, 0, W, H);

                strings.forEach(s => {
                    if (light) {
                        drawStringLight(s, currentStringColor);
                    } else {
                        drawStringDark(s, currentStringColor);
                    }
                });

                balls.forEach(ball => {
                    const s = strings[ball.stringIndex];
                    if (s && s.drawProgress >= 1) {
                        ball.x += ball.speed * ball.direction * dt;
                        if ((ball.direction === 1 && ball.x - ball.radius > W) || (ball.direction === -1 && ball.x + ball.radius < 0)) {
                           ball.x = ball.direction === 1 ? -ball.radius : W + ball.radius;
                        }
                        const y = stringY(s, ball.x);
                        stringsCtx.beginPath();
                        stringsCtx.arc(ball.x, y, ball.radius, 0, Math.PI * 2);
                        stringsCtx.fillStyle = currentBallColor;
                        stringsCtx.save();
                        stringsCtx.shadowBlur = Math.min(18, ball.radius * 3);
                        stringsCtx.shadowColor = currentBallColor;
                        stringsCtx.fill();
                        stringsCtx.restore();
                    }
                });
                animationFrameId = requestAnimationFrame(animateStringsFn);
            }

            function applyTheme() {
                const isDarkMode = localStorage.getItem("darkMode") !== "false";
                if (isDarkMode) {
                    body.classList.add("dark-mode");
                    if(header) header.classList.add("dark-mode");
                    if(icon) { icon.classList.remove("fa-moon"); icon.classList.add("fa-sun"); }
                    currentBallColor = "#00FF00";
                    currentStringColor = "#1b642aff";
                    light = false;
                } else {
                    body.classList.remove("dark-mode");
                    if(header) header.classList.remove("dark-mode");
                    if(icon) { icon.classList.remove("fa-sun"); icon.classList.add("fa-moon"); }
                    currentBallColor = "#EB455F";
                    currentStringColor = "#d4cc89ff";
                    light = true;
                }
                resizeStrings();
            }

            modeToggle.addEventListener("click", () => {
                const isDarkMode = !body.classList.contains("dark-mode");
                localStorage.setItem("darkMode", isDarkMode);
                applyTheme();
            });

            window.addEventListener("resize", () => {
                if (animateStrings) resizeStrings();
            });
            
            // Initial load
            if (localStorage.getItem("darkMode") === "false") {
                body.classList.remove("dark-mode");
            } else {
                body.classList.add("dark-mode");
            }
            applyTheme();
            animationFrameId = requestAnimationFrame(animateStringsFn);

            class TextScrambler {
                constructor(el, slow) { this.el = el; this.slow = slow; this.chars = "!<>-_\\/[]{}—=+*^?#________@%&$0123456789"; this.update = this.update.bind(this); }
                setText(newText) {
                    const oldText = this.el.innerText;
                    const length = Math.max(oldText.length, newText.length);
                    this.queue = [];
                    for (let i = 0; i < length; i++) {
                        const from = oldText[i] || ""; const to = newText[i] || "";
                        const start = Math.floor(Math.random() * (this.slow ? 30 : 20));
                        const end = start + Math.floor(Math.random() * (this.slow ? 40 : 30));
                        this.queue.push({ from, to, start, end, char: "" });
                    }
                    cancelAnimationFrame(this.frameRequest); this.frame = 0; this.update();
                }
                update() {
                    let output = ""; let complete = 0;
                    for (let i = 0, n = this.queue.length; i < n; i++) {
                        let { from, to, start, end, char } = this.queue[i];
                        if (this.frame >= end) { complete++; output += to; } 
                        else if (this.frame >= start) {
                            if (!char || Math.random() < 0.28) { char = this.randomChar(); this.queue[i].char = char; }
                            output += `<span class="dud">${char}</span>`;
                        } else { output += from; }
                    }
                    this.el.innerHTML = output;
                    if (complete === this.queue.length) { return; }
                    this.frameRequest = requestAnimationFrame(this.update); this.frame++;
                }
                randomChar() { return this.chars[Math.floor(Math.random() * this.chars.length)]; }
            }

            document.querySelectorAll(".scramble").forEach((el, index) => {
                const fx = new TextScrambler(el, true);
                setTimeout(() => fx.setText(el.getAttribute("data-text")), 500 + index * 250);
            });
        });
        // --- DOM ELEMENTS ---
        const progressBar = document.getElementById('progressBar');
        const startGameBtn = document.getElementById('startGameBtn');
        const levelSelectionScreen = document.getElementById('levelSelectionScreen');
        const preGamePhase = document.getElementById('preGamePhase');
        const gamePhase = document.getElementById('gamePhase');
        const resultsScreen = document.getElementById('resultsScreen');
        const visitedCountEl = document.getElementById('visitedCount');
        const reportNowBtn = document.getElementById('reportNowBtn');
        const level1Btn = document.getElementById('level1Btn');
        const level2Btn = document.getElementById('level2Btn');
        const levelIndicator = document.getElementById('levelIndicator');
        const levelUnlockMessage = document.getElementById('levelUnlockMessage');
        
        // --- PRE-GAME STATE & LOGIC ---
        let briefingState = {
            howToPlayVisited: false,
            learningCenterVisited: false
        };

        document.querySelectorAll('.nav-btn').forEach(button => {
            button.addEventListener('click', function() {
                const section = this.dataset.section;

                document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');

                document.querySelectorAll('.content-section').forEach(content => content.classList.remove('active'));
                document.getElementById(section + 'Section').classList.add('active');

                if (section === 'howToPlay') briefingState.howToPlayVisited = true;
                if (section === 'learningCenter') briefingState.learningCenterVisited = true;
                
                updateProgress();
            });
        });

        function updateProgress() {
            let progress = 0;
            if (briefingState.howToPlayVisited) progress += 50;
            if (briefingState.learningCenterVisited) progress += 50;
            progressBar.style.width = progress + '%';
            
            if (progress === 100) {
                startGameBtn.disabled = false;
            }
        }
        
        // --- GAME STATE ---
        let gameState = {
            visitedApps: new Set(),
            transactions: [],
            userDecisions: {},
            score: 0,
            currentLevel: 1,
            level2Unlocked: false
        };

        // --- TRANSACTION DATA ---
        const transactionTemplates = [
            { type: 'legit', amount: 15000, sender: 'John Adebayo', ref: 'IP240815001' },
            { type: 'legit', amount: 8500, sender: 'Sarah Okafor', ref: 'IP240815002' },
            { type: 'scam', amount: 25000, sender: 'Michael Chen', ref: 'IP240815003', fakeSms: false }, // Basic scam
            { type: 'scam', amount: 12000, sender: 'Grace Udo', ref: 'IP240815004', fakeSms: true }, // Level 2 Scam
            { type: 'legit', amount: 7500, sender: 'David Ogun', ref: 'IP240815005' },
            { type: 'scam', amount: 18000, sender: 'Fatima Ahmed', ref: 'IP240815006', fakeSms: true }, // Level 2 Scam
            { type: 'legit', amount: 22000, sender: 'Chioma Nwosu', ref: 'IP240815007' },
            { type: 'scam', amount: 9500, sender: 'Bayo Ojo', ref: 'IP240815008', fakeSms: true }, // Level 2 Scam
        ];
        
        // --- GAME LIFECYCLE ---
        level1Btn.addEventListener('click', () => selectLevel(1));
        level2Btn.addEventListener('click', () => selectLevel(2));
        startGameBtn.addEventListener('click', startGame);
        reportNowBtn.addEventListener('click', showDecisionModal);

        function selectLevel(level) {
            gameState.currentLevel = level;
            levelSelectionScreen.style.display = 'none';
            preGamePhase.style.display = 'flex';
            
            // Reset and start pre-game briefing
            briefingState.howToPlayVisited = false;
            briefingState.learningCenterVisited = false;
            document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.content-section').forEach(content => content.classList.remove('active'));
            document.getElementById('howToPlaySection').classList.add('active');
            document.querySelector('[data-section="howToPlay"]').classList.add('active');
            updateProgress();
            startGameBtn.disabled = true;
        }

        function startGame() {
            preGamePhase.style.display = 'none';
            resultsScreen.style.display = 'none';
            gamePhase.classList.add('active');
            levelIndicator.textContent = `LEVEL ${gameState.currentLevel} ACTIVE`;
            console.log("Started Game")
            generateGameRound();
        }
        
        function generateGameRound() {
            // Reset state
            gameState.visitedApps.clear();
            gameState.transactions = [];
            gameState.userDecisions = {};
            reportNowBtn.disabled = true;
            console.log("XXXX")
            
            let potentialTransactions;
            if (gameState.currentLevel === 1) {
                console.log("XXXXa")
                // Level 1: Only legit and basic scams (no fake SMS)
                potentialTransactions = transactionTemplates.filter(t => t.type === 'legit' || !t.fakeSms);
            } else {
                console.log("XXXXb")
                // Level 2: All transaction types are possible
                potentialTransactions = [...transactionTemplates];
            }
            
            const numTransactions = Math.floor(Math.random() * 3) + 3;
            const shuffled = [...potentialTransactions].sort(() => Math.random() - 0.5);
            gameState.transactions = shuffled.slice(0, numTransactions);
            console.log("XXXXc")
            
            // Ensure variety
            const hasScam = gameState.transactions.some(t => t.type === 'scam');
            const hasLegit = gameState.transactions.some(t => t.type === 'legit');
            
            if (!hasScam) {
                console.log("XXXXd")
                gameState.transactions.pop();
                gameState.transactions.push(potentialTransactions.find(t => t.type === 'scam'));
            }
            if (!hasLegit) {
                console.log("XXXXe")
                gameState.transactions.pop();
                gameState.transactions.push(potentialTransactions.find(t => t.type === 'legit'));
            }
            // For level 2, ensure at least one advanced scam
            if (gameState.currentLevel === 2 && !gameState.transactions.some(t => t.fakeSms)) {
                console.log("XXXXf")
                gameState.transactions.pop();
                gameState.transactions.push(transactionTemplates.find(t => t.fakeSms));
            }

            populateAllApps();
            switchApp('whatsapp');
            updateVisitedUI();
        }

        function submitDecisions() {
            if (Object.keys(gameState.userDecisions).length !== gameState.transactions.length) {
                // In a real app, use a custom modal instead of alert()
                console.error('Decision missing for one or more transactions.');
                return;
            }
            
            let correct = 0;
            gameState.transactions.forEach((transaction, index) => {
                if (gameState.userDecisions[index] === transaction.type) {
                    correct++;
                }
            });
            
            gameState.score = Math.round((correct / gameState.transactions.length) * 100);
            
            document.getElementById('decisionModal').classList.remove('active');
            gamePhase.classList.remove('active');
            
            showResults();
        }

        function showResults() {
            const scoreDisplay = document.getElementById('scoreDisplay');
            const resultBreakdown = document.getElementById('resultBreakdown');
            
            scoreDisplay.textContent = gameState.score + '%';
            resultBreakdown.innerHTML = '';
            levelUnlockMessage.textContent = '';

            // This is the logic to unlock Level 2
            if (gameState.score >= 70 && gameState.currentLevel === 1 && !gameState.level2Unlocked) {
                gameState.level2Unlocked = true;
                level2Btn.disabled = false;
                level2Btn.innerHTML = 'Level 2: Advanced Deception';
                levelUnlockMessage.textContent = 'SUCCESS: Level 2 Unlocked!';
            }
            
            gameState.transactions.forEach((transaction, index) => {
                const userDecision = gameState.userDecisions[index];
                const isCorrect = userDecision === transaction.type;
                
                const resultDiv = document.createElement('div');
                resultDiv.className = `result-item ${isCorrect ? 'correct' : 'incorrect'}`;
                resultDiv.innerHTML = `
                    <div>
                        <strong>₦${transaction.amount.toLocaleString()} from ${transaction.sender}</strong><br>
                        <small>Actual: ${transaction.type.toUpperCase()} | Your Choice: ${userDecision.toUpperCase()}</small>
                    </div>
                    <div class="result-status ${isCorrect ? 'status-correct' : 'status-incorrect'}">
                        ${isCorrect ? 'CORRECT' : 'INCORRECT'}
                    </div>
                `;
                resultBreakdown.appendChild(resultDiv);
            });
            
            resultsScreen.style.display = 'block';
        }

        function returnToLevelSelect() {
            resultsScreen.style.display = 'none';
            gamePhase.classList.remove('active');
            preGamePhase.style.display = 'none';
            levelSelectionScreen.style.display = 'flex';
        }
        
        // --- APP POPULATION ---
        function populateAllApps() {
            populateWhatsApp();
            populateInstaPay();
            populateMessages();
        }
        
        function populateWhatsApp() {
            console.log("aa");
            const container = document.getElementById('chatContainer');
            container.innerHTML = `
            <div class="message"><p>Hello, I accidentally sent some money to your account. I need it back urgently. Here are the proofs:</p><div class="message-time">10:15 AM</div></div>
            `;
            console.log("aa");
            gameState.transactions.forEach((t, i) => {
                const messageDiv = document.createElement('div');
                messageDiv.className = 'message';
                messageDiv.innerHTML = `<p>Transfer ${i + 1}:</p><canvas class="transaction-screenshot" width="300" height="150" data-index="${i}"></canvas><div class="message-time">10:${17 + i} AM</div>`;
                container.appendChild(messageDiv);
                setTimeout(() => generateTransactionScreenshot(t, i), 0);
            });
        }
        
        function generateTransactionScreenshot(transaction, index) {
            const canvas = document.querySelector(`canvas[data-index="${index}"]`);
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, 300, 150);
            ctx.strokeStyle = '#00ff00';
            ctx.strokeRect(2, 2, 296, 146);
            
            ctx.fillStyle = '#00ff00';
            ctx.font = 'bold 14px Courier New';
            ctx.fillText('InstaPay Transfer Receipt', 10, 20);
            
            ctx.fillStyle = '#ffffff';
            ctx.font = '12px Courier New';
            ctx.fillText(`Amount: ₦${transaction.amount.toLocaleString()}`, 10, 45);
            ctx.fillText(`From: ${transaction.sender}`, 10, 65);
            ctx.fillText(`Ref: ${transaction.ref}`, 10, 85);
            ctx.fillStyle = '#00ff00';
            ctx.fillText('Status: SUCCESSFUL', 10, 110);
        }
        
        function populateInstaPay() {
            const container = document.getElementById('bankTransactions');
            container.innerHTML = ''; // Clear previous
            const legitTransactions = gameState.transactions.filter(t => t.type === 'legit');
            
            legitTransactions.forEach(t => {
                container.innerHTML += `
                    <div class="transaction-item">
                        <div class="transaction-details"><h4>${t.sender}</h4><p>${t.ref}</p></div>
                        <div class="transaction-amount amount-credit">+₦${t.amount.toLocaleString()}.00</div>
                    </div>`;
            });
        }
        
        function populateMessages() {
            const container = document.getElementById('smsMessages');
            container.innerHTML = '';
            
            const transactionsWithSms = gameState.transactions.filter(t => t.type === 'legit' || t.fakeSms);

            transactionsWithSms.forEach(t => {
                const isScamSms = t.type === 'scam' && t.fakeSms;
                const senderClass = isScamSms ? 'sender-scam' : '';
                const senderName = isScamSms ? '+234 801 234 5678' : 'InstaPay Alerts';
                
                container.innerHTML += `
                    <div class="message-thread">
                        <div class="thread-sender ${senderClass}">${senderName}</div>
                        <div class="thread-preview">₦${t.amount.toLocaleString()}.00 received from ${t.sender}. Ref: ${t.ref}</div>
                        <div class="thread-time">10:18 AM</div>
                    </div>`;
            });
        }
        
        // --- APP NAVIGATION ---
        document.querySelectorAll('.app-btn').forEach(button => {
            button.addEventListener('click', () => switchApp(button.dataset.app));
        });

        function switchApp(appName) {
            gameState.visitedApps.add(appName);
            updateVisitedUI();
            
            document.querySelectorAll('.app-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-app="${appName}"]`).classList.add('active');
            
            document.querySelectorAll('.app-screen').forEach(screen => screen.classList.remove('active'));
            document.getElementById(`${appName}Screen`).classList.add('active');
        }
        
        function updateVisitedUI() {
            visitedCountEl.textContent = gameState.visitedApps.size;
            document.querySelectorAll('.app-btn').forEach(btn => {
                if (gameState.visitedApps.has(btn.dataset.app)) {
                    btn.classList.add('visited');
                } else {
                    btn.classList.remove('visited');
                }
            });

            if (gameState.visitedApps.size === 3) {
                reportNowBtn.disabled = false;
            }
        }

        function showDecisionModal() {
            const modal = document.getElementById('decisionModal');
            const container = document.getElementById('transactionDecisions');
            container.innerHTML = '';
            
            gameState.transactions.forEach((t, i) => {
                container.innerHTML += `
                    <div class="transaction-decision">
                        <h4>Tx ${i + 1}: ₦${t.amount.toLocaleString()} from ${t.sender}</h4>
                        <div class="decision-buttons">
                            <button class="decision-btn btn-legit" data-index="${i}" data-decision="legit"><i class="fas fa-check"></i> Legitimate</button>
                            <button class="decision-btn btn-scam" data-index="${i}" data-decision="scam"><i class="fas fa-times"></i> Scam</button>
                        </div>
                    </div>`;
            });
            
            modal.classList.add('active');
            
            document.querySelectorAll('.decision-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = this.dataset.index;
                    gameState.userDecisions[index] = this.dataset.decision;
                    
                    this.parentElement.querySelectorAll('.decision-btn').forEach(b => b.classList.remove('selected'));
                    this.classList.add('selected');
                });
            });
        }

    </script>
    
</body>
</html>
